import{r as d,j as p,o as f,c as r,d as l,f as t,e as v,t as n,n as b}from"./index-B4jSO19r.js";const y={class:"text-gray-800 dark:text-gray-200"},_={class:"stats-content container mx-auto px-4 py-8"},w={key:0,class:"loading-container flex flex-col items-center justify-center py-20"},k={key:1,class:"stats-grid grid grid-cols-1 lg:grid-cols-3 gap-4 mb-10"},z={class:"stat-card bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow duration-300 flex flex-col items-center text-center"},B={class:"stat-content"},M={class:"stat-number text-2xl font-bold mb-1"},S={class:"stat-card bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow duration-300 flex flex-col items-center text-center"},N={class:"stat-content"},T={class:"stat-number text-2xl font-bold mb-1"},j={class:"stat-card bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow duration-300 flex flex-col items-center text-center"},C={class:"stat-content"},F={class:"stat-number text-2xl font-bold mb-1"},V={__name:"Stats",setup(E){const i=d(!1),a=d({total_images:0,total_size:0,today_uploads:0,month_uploads:0,average_size:0,max_size:0,upload_trend:[]}),o=d({show:!1,message:"",type:"success"});p(()=>a.value.upload_trend.length?Math.max(...a.value.upload_trend.map(e=>e.count)):0);const m=async()=>{i.value=!0;try{const e=await fetch("/api/stats/dashboard",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!e.ok){if(e.status===401){localStorage.removeItem("authToken"),window.location.href="/login",u("登录已过期，请重新登录","error");return}throw new Error("加载统计数据失败")}const s=await e.json();a.value={...a.value,...s.data||{}}}catch(e){console.error("加载统计数据错误:",e),u("加载统计数据失败: "+e.message,"error")}finally{i.value=!1}},c=e=>e?e.toLocaleString("zh-CN"):"0",x=e=>{if(!e)return"0 B";const s=1024,h=["B","KB","MB","GB","TB"],g=Math.floor(Math.log(e)/Math.log(s));return parseFloat((e/Math.pow(s,g)).toFixed(2))+" "+h[g]},u=(e,s="success")=>{o.value={show:!0,message:e,type:s},setTimeout(()=>o.value.show=!1,3e3)};return f(()=>{m()}),(e,s)=>(l(),r("div",y,[t("div",_,[s[7]||(s[7]=t("div",{class:"stats-header mb-8 text-center"},[t("h1",{class:"stats-title text-3xl font-bold mb-2"},"系统统计"),t("p",{class:"stats-subtitle text-gray-600 dark:text-gray-400"},"查看图床系统的使用情况和统计数据")],-1)),i.value?(l(),r("div",w,[...s[0]||(s[0]=[t("div",{class:"spinner w-10 h-10 border-4 border-gray-200 dark:border-gray-700 border-t-primary dark:border-t-primary rounded-full animate-spin mb-4"},null,-1),t("p",{class:"text-gray-600 dark:text-gray-400"},"加载统计数据中...",-1)])])):(l(),r("div",k,[t("div",z,[s[2]||(s[2]=t("div",{class:"stat-icon text-4xl mb-4"},[t("i",{class:"ri-image-circle-line"})],-1)),t("div",B,[t("h3",M,n(c(a.value.total_images)),1),s[1]||(s[1]=t("p",{class:"stat-label text-gray-600 dark:text-gray-400"},"总图片数",-1))])]),t("div",S,[s[4]||(s[4]=t("div",{class:"stat-icon text-4xl mb-4"},[t("i",{class:"ri-folder-3-line"})],-1)),t("div",N,[t("h3",T,n(x(a.value.total_size)),1),s[3]||(s[3]=t("p",{class:"stat-label text-gray-600 dark:text-gray-400"},"总存储空间",-1))])]),t("div",j,[s[6]||(s[6]=t("div",{class:"stat-icon text-4xl mb-4"},[t("i",{class:"ri-calendar-line"})],-1)),t("div",C,[t("h3",F,n(c(a.value.month_uploads)),1),s[5]||(s[5]=t("p",{class:"stat-label text-gray-600 dark:text-gray-400"},"本月上传",-1))])])]))]),o.value.show?(l(),r("div",{key:0,class:b(["notification fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300 transform translate-y-0 opacity-100",[o.value.type==="success"?"bg-green-500 text-white":"bg-red-500 text-white"]])},n(o.value.message),3)):v("",!0)]))}};export{V as default};
