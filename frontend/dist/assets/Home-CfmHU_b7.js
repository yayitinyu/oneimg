import{r as n,j as me,o as ve,b as he,c as o,d as i,f as l,k as xe,n as f,i as P,l as V,t as b,m as fe,g as O,v as be,h as we,e as L,F as J,p as q,q as ke,T as ye,s as g,u as _e,x as K}from"./index-BDcH1WRC.js";import{e as Ce}from"./error-BfqPR-Rg.js";const Ie={class:"pt-10 md:pt-14 lg:pt-16 px-4 md:px-6 lg:px-8 xl:container xl:mx-auto"},Me={class:"upload-section mb-6"},$e={class:"bg-white dark:bg-dark-200 rounded-2xl p-5 transition-all duration-300 shadow-lg dark:shadow-dark-md border border-light-200/80 dark:border-dark-100/80"},Le={class:"flex items-center justify-between mb-4"},Pe={class:"flex items-center gap-2 bg-light-100 dark:bg-dark-100 rounded-lg p-1"},je={key:0},De={key:0,class:"upload-content py-12 px-4 text-center"},Te={key:1,class:"upload-progress py-16 px-4 text-center"},Be={class:"text-secondary text-sm mb-3"},Se={class:"progress-bar w-full max-w-md mx-auto h-2 bg-light-200 dark:bg-dark-100 rounded-full overflow-hidden"},ze={key:1,class:"url-upload-area"},Ee={class:"flex flex-col gap-4 py-8 px-4"},Re={class:"flex flex-col sm:flex-row gap-3 max-w-xl mx-auto w-full"},Ae=["disabled"],Ue=["disabled"],Fe={key:0,class:"ri-loader-4-line animate-spin"},We={key:1,class:"ri-upload-2-line"},Ze={class:"recent-section"},Ne={class:"flex justify-between items-center mb-3 flex-wrap gap-2"},Ge={class:"flex items-center gap-2"},He={class:"text-sm text-secondary"},Ve={key:1,class:"ml-2 text-sm text-primary font-medium"},Oe={key:0,class:"recent-skeleton grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Je={key:1,class:"recent-grid grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},qe=["onClick"],Ke={key:0,class:"ri-check-line text-sm"},Qe=["onClick"],Xe=["src","alt"],Ye={class:"flex items-center gap-3 justify-between px-3 py-2 bg-white/95 dark:bg-dark-200/90 rounded-b-2xl shadow-inner"},et={class:"flex flex-col min-w-0"},tt={class:"recent-filename text-sm font-medium text-gray-800 dark:text-light-100 truncate"},rt={class:"text-[11px] text-secondary leading-tight truncate"},lt={class:"flex items-center gap-2"},st=["onClick"],at={class:"copy-dropdown absolute right-0 top-full mt-1 w-36 bg-white/95 dark:bg-dark-200/95 rounded-2xl shadow-2xl border border-light-200/80 dark:border-dark-100/80 backdrop-blur-xl"},ot={class:"p-1.5 grid grid-cols-2 gap-1.5"},it=["onClick"],nt=["onClick"],dt=["onClick"],ct=["onClick"],ut=["onClick"],pt=["onClick"],gt={key:2,class:"no-images bg-white dark:bg-dark-200 rounded-xl shadow-md dark:shadow-dark-md p-8 text-center"},mt={key:0,class:"fixed bottom-6 right-6 z-50 flex flex-col items-end gap-3"},vt={class:"floating-menu-badge bg-white dark:bg-gray-800 px-4 py-2 rounded-full shadow-lg text-sm font-medium text-center"},ht={class:"floating-menu-buttons flex flex-col items-end gap-2"},xt=["title"],ft=["disabled"],bt=["disabled"],_t={__name:"Home",setup(wt){const w=e=>e?e.startsWith("http://")||e.startsWith("https://")||e.startsWith("//")?e:typeof window<"u"?window.location.origin+e:e:"",k=n(!1),h=n(!1),j=n(0),x=n(0),c=n([]),D=n(!0),T=n(null),C=n("file"),I=n(""),y=n(!1),u=n(null);let m=null,d=null;const v=n(!1),a=n([]),B=me(()=>c.value.length>0&&a.value.length===c.value.length),Q=()=>{v.value=!0,a.value=[]},R=()=>{v.value=!1,a.value=[]},A=e=>{const t=a.value.indexOf(e);t===-1?a.value.push(e):a.value.splice(t,1)},S=e=>a.value.includes(e),X=()=>{B.value?a.value=[]:a.value=c.value.map(e=>e.id)},Y=async()=>{if(a.value.length===0)return;new PopupModal({title:"确认删除记录",content:`
            <div class="flex gap-3">
                <i class="ri-error-warning-line text-orange-500 text-xl mt-1"></i>
                <div>
                    <p>确定要删除选中的 <strong>${a.value.length}</strong> 条上传记录吗？</p>
                    <p class="mt-1 text-secondary text-sm">注意：仅删除记录，图片文件仍保留在存储中，画廊可能仍可见</p>
                </div>
            </div>
        `,buttons:[{text:"取消",type:"default",callback:t=>t.close()},{text:"确认删除",type:"danger",callback:async t=>{t.close(),await ee()}}],maskClose:!0}).open()},ee=async()=>{const e=Loading.show({text:`正在删除 ${a.value.length} 条记录...`,color:"#ff4d4f",mask:!0});let t=0,r=0;for(const s of a.value)try{(await fetch(`/api/images/${s}/record`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}})).ok?t++:r++}catch(p){console.error("删除记录错误:",p),r++}await e.hide(),r===0?Message.success(`成功删除 ${t} 条记录`):Message.warning(`删除完成：成功 ${t} 条，失败 ${r} 条`),R(),M()},te=async()=>{if(a.value.length===0)return;const e=c.value.filter(r=>a.value.includes(r.id)),t=e.map(r=>w(r.url)).join(`
`);try{await navigator.clipboard.writeText(t),Message.success(`已复制 ${e.length} 个链接到剪贴板`)}catch(r){console.error("复制失败:",r),Message.error("复制失败")}},re=e=>{u.value===e?u.value=null:u.value=e},U=e=>{if(u.value!==null){const t=document.querySelectorAll(".recent-item .relative.z-50");let r=!1;t.forEach(s=>{s.contains(e.target)&&(r=!0)}),r||(u.value=null)}},le=e=>{e.preventDefault(),k.value=!0},se=e=>{e.preventDefault(),k.value=!0},ae=e=>{e.preventDefault(),e.currentTarget.contains(e.relatedTarget)||(k.value=!1)},oe=e=>{e.preventDefault(),k.value=!1;const r=Array.from(e.dataTransfer.files).filter(s=>s.type.startsWith("image/"));r.length>0?z(r):Message.error("请拖拽图片文件",{duration:3e3,position:"top-right"})},ie=()=>{!h.value&&T.value&&T.value.click()},ne=e=>{const t=Array.from(e.target.files);t.length>0&&z(t),e.target.value=""},F=async e=>{const t=e.clipboardData.items,r=[];for(let s of t)if(s.type.startsWith("image/")){const p=s.getAsFile();if(p){const _=new Date().getTime(),pe=s.type.split("/")[1]||"png",ge=new File([p],`paste-${_}.${pe}`,{type:s.type});r.push(ge)}}r.length>0&&(e.preventDefault(),z(r),Message.success(`从剪贴板粘贴了 ${r.length} 个图片`,{duration:2e3,position:"top-right"}))},z=async e=>{if(h.value)return;h.value=!0,j.value=e.length,x.value=0;const t=new FormData;e.forEach(r=>{t.append("images[]",r)});try{const r=setInterval(()=>{x.value<95&&(x.value+=Math.random()*5)},150),s=await fetch("/api/upload/images",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:t});clearInterval(r),x.value=100;const p=await s.json();if(s.ok&&p.code===200)await M(),Message.success("上传成功",{duration:2e3,position:"top-right"});else throw new Error(p.message||"上传失败")}catch(r){console.error("上传错误:",r),Message.error(`上传失败: ${r.message}`,{duration:3e3,position:"top-right",showClose:!0})}finally{h.value=!1,j.value=0,x.value=0}},W=async()=>{const e=I.value.trim();if(!e){Message.warning("请输入图片URL");return}if(!e.startsWith("http://")&&!e.startsWith("https://")){Message.error("URL必须以 http:// 或 https:// 开头");return}y.value=!0;try{const t=await fetch("/api/upload/url",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({url:e})}),r=await t.json();if(t.ok&&r.code===200)I.value="",await M(),Message.success("URL图片上传成功",{duration:2e3,position:"top-right"});else throw new Error(r.message||"URL上传失败")}catch(t){console.error("URL上传错误:",t),Message.error(`上传失败: ${t.message}`,{duration:3e3,position:"top-right",showClose:!0})}finally{y.value=!1}},M=async()=>{D.value=!0;try{const e=await fetch("/api/images?limit=12&visibility=visible",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(e.ok){const t=await e.json();c.value=Array.isArray(t.data?.images)?t.data.images:[]}}catch(e){console.error("加载图片失败:",e),c.value=[],Message.error(`加载图片失败: ${e.message}`,{duration:3e3,position:"top-right",showClose:!0})}finally{D.value=!1}},$=async(e,t)=>{if(!e)return;const r=w(e.url);let s="";switch(t){case"url":s=r;break;case"html":s=`<img src="${r}" alt="${e.filename}" width="${e.width||""}" height="${e.height||""}">`;break;case"markdown":s=`![img](${r})`;break;case"bbcode":s=`[img]${r}[/img]`;break;default:s=r}try{await navigator.clipboard.writeText(s),Message.success(`已复制${Z(t)}格式`,{duration:1500,position:"top-center",zIndex:2e4})}catch{const _=document.createElement("textarea");_.value=s,document.body.appendChild(_),_.select(),document.execCommand("copy"),document.body.removeChild(_),Message.success(`已复制${Z(t)}格式`,{duration:1500,position:"top-center",zIndex:2e4})}finally{K(()=>{u.value=null})}},Z=e=>{switch(e){case"url":return"URL";case"html":return"HTML";case"markdown":return"Markdown";case"bbcode":return"BBCode";default:return""}},E=e=>e?new Date(e).toLocaleString("zh-CN"):"",N=async e=>{new PopupModal({title:"确认删除记录",content:`
      <div class="flex gap-3">
        <i class="ri-error-warning-line text-orange-500 text-xl mt-1"></i>
        <div>
          <p>确定要删除这条上传记录吗？</p>
          <p class="mt-1 text-secondary text-sm">注意：仅删除记录，图片文件仍保留在存储中</p>
        </div>
      </div>
    `,buttons:[{text:"取消",type:"default",callback:r=>r.close()},{text:"确认删除",type:"danger",callback:async r=>{r.close(),await de(e)}}],maskClose:!0}).open()},de=async e=>{const t=Loading.show({text:"删除中...",color:"#ff4d4f",mask:!0});try{const r=await fetch(`/api/images/${e}/record`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}});if(r.ok)Message.success("记录删除成功",{duration:1500,position:"top-right"}),m?.id===e&&d&&(d.close(),m=null,d=null),u.value=null,await M();else{const s=await r.json();throw new Error(s.message||"删除失败")}}catch(r){console.error("删除图片错误:",r),Message.error(`删除失败: ${r.message}`,{duration:3e3,position:"top-right",showClose:!0})}finally{await t.hide()}},G=e=>{if(!e||e<0)return"0 B";const t=1024,r=["B","KB","MB","GB"],s=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,s)).toFixed(2))+" "+r[s]},ce=e=>{if(!e||!e.url){Message.error("图片信息不完整，无法预览",{duration:2e3,position:"top-right"});return}m=e;const t=`
    <div class="image-preview-popup w-full max-w-5xl max-h-[85vh] flex flex-col overflow-hidden bg-white/85 dark:bg-dark-200/85 glass-card rounded-2xl">
      <!-- 顶部操作栏 -->
      <div class="preview-header bg-light-50/70 dark:bg-dark-300/70 pb-2 flex flex-wrap justify-between items-center gap-2 px-3">
        <h3 class="text-xs font-medium truncate max-w-[55%]">${e.filename}</h3>
        <div class="flex gap-2 flex-wrap justify-end items-center w-full sm:w-auto">
          <div class="flex gap-1 flex-1 min-w-[180px]">
            <button class="px-3 py-1.5 text-xs rounded-full bg-light-200/80 dark:bg-dark-300/80 text-secondary hover:text-primary hover:bg-light-100 dark:hover:bg-dark-200 flex items-center gap-1" onclick="event.stopPropagation(); window.copyPreviewImageLink('url')">
              <i class="ri-link text-primary"></i>
              <span class="font-semibold">URL</span>
            </button>
            <button class="px-3 py-1.5 text-xs rounded-full bg-light-200/80 dark:bg-dark-300/80 text-secondary hover:text-primary hover:bg-light-100 dark:hover:bg-dark-200 flex items-center gap-1" onclick="event.stopPropagation(); window.copyPreviewImageLink('markdown')">
              <i class="ri-markdown-line text-blue-500"></i>
              <span class="font-semibold">MD</span>
            </button>
            <button class="px-3 py-1.5 text-xs rounded-full bg-light-200/80 dark:bg-dark-300/80 text-secondary hover:text-primary hover:bg-light-100 dark:hover:bg-dark-200 flex items-center gap-1" onclick="event.stopPropagation(); window.copyPreviewImageLink('html')">
              <i class="ri-html5-line text-orange-500"></i>
              <span class="font-semibold">HTML</span>
            </button>
            <button class="px-3 py-1.5 text-xs rounded-full bg-light-200/80 dark:bg-dark-300/80 text-secondary hover:text-primary hover:bg-light-100 dark:hover:bg-dark-200 flex items-center gap-1" onclick="event.stopPropagation(); window.copyPreviewImageLink('bbcode')">
              <i class="ri-brackets-line text-purple-500"></i>
              <span class="font-semibold">BB</span>
            </button>
          </div>
          <div class="flex gap-2">
            <button
              class="halo-button halo-button-primary px-3 py-1.5 text-xs whitespace-nowrap flex items-center gap-1"
              onclick="event.stopPropagation(); window.downloadPreviewImage()"
            >
              <i class="ri-download-fill text-xs"></i>
              下载
            </button>
            <button
              class="halo-button halo-button-danger px-3 py-1.5 text-xs whitespace-nowrap flex items-center gap-1"
              onclick="event.stopPropagation(); window.deletePreviewImage()"
            >
              <i class="ri-delete-bin-fill text-xs"></i>
              删除
            </button>
          </div>
        </div>
      </div>
      
      <!-- 预览图片区域 -->
      <div class="max-h-[360px] flex-1 overflow-auto flex items-center justify-center">
        <a 
            class="spotlight min-w-full max-w-full min-h-[260px] block" 
            href="${w(e.url)}" 
            data-description="尺寸: ${e.width||"未知"}×${e.height||"未知"} | 大小: ${G(e.file_size||0)} | 上传日期：${E(e.created_at)}"
        >
            <div class="relative max-w-full w-fill max-h-[360px] min-h-[260px] rounded-lg overflow-hidden image-skeleton flex items-center justify-center">
                <img 
                    src="${w(e.url)}"
                    alt="${e.filename}" 
                    class="max-w-full w-fill max-h-[360px] min-h-[260px] object-contain rounded-lg relative z-10 opacity-0"
                    onload="this.classList.add('image-fade-in'); this.classList.remove('opacity-0'); this.parentElement.classList.remove('image-skeleton')"
                    onerror="this.parentElement.classList.remove('image-skeleton'); this.classList.remove('opacity-0'); this.src='${Ce}';"
                />
            </div>
        </a>
      </div>
      
      <!-- 底部信息栏 -->
      <!-- 底部信息栏 -->
      <div class="pt-2 flex flex-wrap gap-2 text-xs text-secondary ml-1 px-1">
        <div class="flex items-center gap-1.5">
          <i class="ri-ruler-line w-3.5 text-center"></i>
          尺寸: ${e.width||"未知"}×${e.height||"未知"}
        </div>
        <div class="flex items-center gap-1.5">
          <i class="ri-image-line w-3.5 text-center"></i>
          大小: ${G(e.file_size||0)}
        </div>
        <div class="flex items-center gap-1.5">
          <i class="ri-hard-drive-2-line w-3.5 text-center"></i>
          存储: ${e.storage==="telegram"?"Telegram":(e.storage==="default"?"本地":e.storage)||"未知"}
        </div>
        <div class="flex items-center gap-1.5">
          <i class="ri-calendar-line w-3.5 text-center"></i>
          上传日期：${E(e.created_at)}
        </div>
      </div>
    </div>
  `;window.copyPreviewImageLink=r=>{$(m,r)},window.downloadPreviewImage=()=>{H(m)},window.deletePreviewImage=()=>{N(m.id),closePreviewModal()},window.closePreviewModal=()=>{d&&(d.close(),m=null,d=null)},d=new PopupModal({title:"图片预览",content:t,type:"default",buttons:[{text:"确定",type:"default",callback:r=>r.close()}],maskClose:!0,zIndex:1e4,maxHeight:"90vh",onClose:()=>{window.copyPreviewImageLink=null,window.downloadPreviewImage=null,window.deletePreviewImage=null,window.closePreviewModal=null,m=null,d=null}}),d.open(),K(()=>{const r=document.querySelector(".image-preview-popup");r&&r.addEventListener("click",s=>{s.stopPropagation()})})},H=e=>{if(!e||!e.url){Message.error("图片信息不完整，无法下载",{duration:2e3,position:"top-right"});return}const t=w(e.url),r=document.createElement("a");r.href=t,r.download=e.filename||`image-${Date.now()}.png`,document.body.appendChild(r),r.click(),document.body.removeChild(r),Message.info("开始下载图片",{duration:1500,position:"top-right"}),u.value=null},ue=e=>{console.error("Image load failed for:",e.target.src),e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuWbvueJh+WKoOi9veWksei0pTwvdGV4dD48L3N2Zz4="};return ve(()=>{document.addEventListener("paste",F),document.addEventListener("click",U),setTimeout(()=>{M()},100)}),he(()=>{document.removeEventListener("paste",F),document.removeEventListener("click",U),window.copyPreviewImageLink=null,window.downloadPreviewImage=null,window.deletePreviewImage=null,window.closePreviewModal=null,d&&d.close(),window.onmessage&&Message.closeAll()}),(e,t)=>(i(),o("div",Ie,[l("section",Me,[l("div",$e,[l("div",Le,[t[6]||(t[6]=l("div",{class:"section-title"},null,-1)),l("div",Pe,[l("button",{onClick:t[0]||(t[0]=r=>C.value="file"),class:f(["px-3 py-1.5 text-sm rounded-md transition-all duration-200",C.value==="file"?"bg-white dark:bg-dark-200 text-primary shadow-sm":"text-secondary hover:text-primary"])},[...t[4]||(t[4]=[l("i",{class:"ri-file-image-line mr-1"},null,-1),P("文件 ",-1)])],2),l("button",{onClick:t[1]||(t[1]=r=>C.value="url"),class:f(["px-3 py-1.5 text-sm rounded-md transition-all duration-200",C.value==="url"?"bg-white dark:bg-dark-200 text-primary shadow-sm":"text-secondary hover:text-primary"])},[...t[5]||(t[5]=[l("i",{class:"ri-link mr-1"},null,-1),P("URL ",-1)])],2)])]),C.value==="file"?(i(),o("div",je,[l("div",{class:f(["upload-area group relative rounded-2xl border-2 border-dashed transition-all duration-300 cursor-pointer overflow-hidden hover:border-primary/50 hover:shadow-[0_0_15px_rgba(var(--primary-rgb),0.1)] dark:hover:shadow-[0_0_15px_rgba(var(--primary-rgb),0.2)]",{"border-primary/30 bg-primary/5 dark:bg-primary/5":k.value,"border-light-300 dark:border-dark-100 bg-white dark:bg-dark-200/60":!k.value&&!h.value,"border-primary/50 bg-primary/10 dark:bg-primary/10":h.value}]),onDrop:oe,onDragover:le,onDragenter:se,onDragleave:ae,onClick:ie},[h.value?(i(),o("div",Te,[t[8]||(t[8]=l("div",{class:"spinner w-10 h-10 border-4 border-primary/30 border-t-primary rounded-full animate-spin mx-auto mb-3"},null,-1)),l("p",Be," 正在上传 "+b(j.value)+" 个文件（"+b(Math.round(x.value))+"%） ",1),l("div",Se,[l("div",{class:"progress-fill h-full bg-primary transition-all duration-300 ease-out",style:fe({width:x.value+"%"})},null,4)])])):(i(),o("div",De,[...t[7]||(t[7]=[V('<div class="upload-icon mb-6 flex justify-center"><div class="w-20 h-16 bg-white dark:bg-gray-700/50 rounded-xl flex items-center justify-center border border-gray-100 dark:border-gray-600 shadow-sm transition-all duration-300 group-hover:-translate-y-1 group-hover:shadow-[0_10px_20px_rgba(59,130,246,0.1)] dark:group-hover:shadow-[0_10px_20px_rgba(59,130,246,0.15)]"><i class="ri-arrow-up-line text-3xl text-gray-400 dark:text-gray-500 group-hover:text-primary transition-colors"></i></div></div><h3 class="text-xl font-bold text-gray-700 dark:text-gray-200 mb-2"> Click, Paste or Drop </h3><p class="text-gray-400 text-sm mb-6 font-medium"> JPG, PNG, GIF, WEBP </p><button class="hidden bg-primary/10 text-primary px-6 py-2 rounded-full font-medium hover:bg-primary/20 transition-colors duration-200 items-center justify-center gap-2 mx-auto"><i class="ri-add-line"></i> 选择图片 </button><p class="paste-tip text-sm text-secondary flex items-center justify-center gap-2 mt-3"> 支持 Ctrl+V 粘贴剪贴板图片，或直接拖入图片 </p>',5)])]))],34)])):(i(),o("div",ze,[l("div",Ee,[t[9]||(t[9]=l("div",{class:"text-center mb-2"},[l("div",{class:"text-4xl text-primary mb-2"},[l("i",{class:"ri-link"})]),l("p",{class:"text-secondary text-sm"}," 粘贴图片直链地址，支持 http/https 协议 ")],-1)),l("div",Re,[O(l("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>I.value=r),type:"url",placeholder:"请输入图片URL，如 https://example.com/image.jpg",class:"flex-1 px-4 py-3 rounded-xl border border-light-300 dark:border-dark-100 bg-white dark:bg-dark-200 focus:ring-2 focus:ring-primary focus:border-primary outline-none transition-all w-full",onKeydown:we(W,["enter"]),disabled:y.value},null,40,Ae),[[be,I.value]]),l("button",{onClick:W,disabled:!I.value.trim()||y.value,class:"px-6 py-3 bg-primary hover:bg-primary-dark text-white rounded-xl transition-colors duration-200 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed w-full sm:w-auto shrink-0"},[y.value?(i(),o("i",Fe)):(i(),o("i",We)),l("span",null,b(y.value?"上传中...":"上传"),1)],8,Ue)])])])),l("input",{ref_key:"fileInput",ref:T,type:"file",multiple:"",accept:"image/*",onChange:ne,class:"hidden"},null,544)])]),l("section",Ze,[l("div",Ne,[t[11]||(t[11]=l("h2",{class:"section-title text-lg font-semibold flex items-center gap-2"},[l("i",{class:"ri-history-line text-primary"}),P(" 最近上传 ")],-1)),l("div",Ge,[l("span",He,b(c.value.length)+" 张图片",1),!v.value&&c.value.length>0?(i(),o("button",{key:0,onClick:Q,class:"ml-2 px-3 py-1.5 text-sm rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-all flex items-center gap-1"},[...t[10]||(t[10]=[l("i",{class:"ri-checkbox-multiple-line"},null,-1),P(" 批量管理 ",-1)])])):L("",!0),v.value?(i(),o("span",Ve,"批量模式已开启")):L("",!0)])]),D.value?(i(),o("div",Oe,[(i(),o(J,null,q(6,r=>l("div",{key:r,class:"rounded-2xl bg-white dark:bg-dark-100 border border-light-200/80 dark:border-dark-100/80 overflow-hidden"},[...t[12]||(t[12]=[V('<div class="aspect-video bg-gray-200 dark:bg-dark-200/50 animate-pulse"></div><div class="px-3 py-2 bg-white/95 dark:bg-dark-200/90 border-t border-light-200/50 dark:border-dark-100/50 flex justify-between items-center"><div class="w-1/2 h-4 bg-gray-200 dark:bg-dark-300 rounded animate-pulse"></div><div class="flex gap-2"><div class="w-8 h-8 rounded bg-gray-200 dark:bg-dark-300 animate-pulse"></div><div class="w-8 h-8 rounded bg-gray-200 dark:bg-dark-300 animate-pulse"></div><div class="w-8 h-8 rounded bg-gray-200 dark:bg-dark-300 animate-pulse"></div></div></div>',2)])])),64))])):c.value.length>0?(i(),o("div",Je,[(i(!0),o(J,null,q(c.value,r=>(i(),o("div",{key:r.id,class:f(["recent-item rounded-2xl bg-white dark:bg-dark-100 transition-all duration-300 hover:shadow-xl dark:hover:shadow-dark-md group relative overflow-visible flex flex-col border border-light-200/80 dark:border-dark-100/80",{"ring-2 ring-primary":v.value&&S(r.id)}])},[v.value?(i(),o("div",{key:0,class:"absolute top-2 right-2 z-10",onClick:g(s=>A(r.id),["stop"])},[l("div",{class:f(["w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all cursor-pointer",S(r.id)?"bg-primary border-primary text-white":"bg-white/90 dark:bg-gray-800/90 border-gray-300 dark:border-gray-600"])},[S(r.id)?(i(),o("i",Ke)):L("",!0)],2)],8,qe)):L("",!0),l("div",{class:"aspect-video overflow-hidden cursor-pointer rounded-t-2xl",onClick:g(s=>v.value?A(r.id):ce(r),["stop"])},[t[13]||(t[13]=l("div",{class:"loading absolute inset-0 flex items-center justify-center pointer-events-none"},[l("i",{class:"ri-loader-4-line text-3xl animate-spin text-gray-300 dark:text-gray-600"})],-1)),l("img",{src:w(r.thumbnail||r.url),alt:r.filename||"图片预览",class:"recent-image w-full h-full object-cover transition-all duration-500 group-hover:scale-110 opacity-0",loading:"lazy",referrerpolicy:"no-referrer",onLoad:t[3]||(t[3]=s=>{s.target.classList.remove("opacity-0"),s.target.parentElement.querySelector(".loading").classList.add("hidden")}),onError:ue},null,40,Xe)],8,Qe),l("div",Ye,[l("div",et,[l("p",tt,b(r.filename),1),l("p",rt,b(E(r.created_at)),1)]),l("div",lt,[l("div",{class:f(["relative",{"z-50":u.value===r.id}])},[l("button",{class:"halo-button-copy h-8 w-8 flex items-center justify-center",title:"复制链接",onClick:g(s=>re(r.id),["stop"])},[...t[14]||(t[14]=[l("i",{class:"ri-code-s-slash-line text-sm"},null,-1)])],8,st),O(l("div",at,[l("div",ot,[l("button",{onClick:g(s=>$(r,"url"),["stop"]),class:"w-full text-left px-2 py-1.5 text-[11px] text-gray-800 dark:text-light-100 hover:bg-light-100 dark:hover:bg-dark-300 rounded-lg transition-colors duration-200 flex items-center gap-1.5"},[...t[15]||(t[15]=[l("i",{class:"ri-link text-primary"},null,-1),l("span",{class:"font-semibold"},"URL",-1)])],8,it),l("button",{onClick:g(s=>$(r,"markdown"),["stop"]),class:"w-full text-left px-2 py-1.5 text-[11px] text-gray-800 dark:text-light-100 hover:bg-light-100 dark:hover:bg-dark-300 rounded-lg transition-colors duration-200 flex items-center gap-1.5"},[...t[16]||(t[16]=[l("i",{class:"ri-markdown-line text-blue-500"},null,-1),l("span",{class:"font-semibold"},"MD",-1)])],8,nt),l("button",{onClick:g(s=>$(r,"html"),["stop"]),class:"w-full text-left px-2 py-1.5 text-[11px] text-gray-800 dark:text-light-100 hover:bg-light-100 dark:hover:bg-dark-300 rounded-lg transition-colors duration-200 flex items-center gap-1.5"},[...t[17]||(t[17]=[l("i",{class:"ri-html5-line text-orange-500"},null,-1),l("span",{class:"font-semibold"},"HTML",-1)])],8,dt),l("button",{onClick:g(s=>$(r,"bbcode"),["stop"]),class:"w-full text-left px-2 py-1.5 text-[11px] text-gray-800 dark:text-light-100 hover:bg-light-100 dark:hover:bg-dark-300 rounded-lg transition-colors duration-200 flex items-center gap-1.5"},[...t[18]||(t[18]=[l("i",{class:"ri-brackets-line text-purple-500"},null,-1),l("span",{class:"font-semibold"},"BB",-1)])],8,ct)])],512),[[_e,u.value===r.id]])],2),l("button",{onClick:g(s=>H(r),["stop"]),class:"halo-button halo-button-primary h-8 w-8 flex items-center justify-center bg-white dark:bg-dark-200",title:"下载图片"},[...t[19]||(t[19]=[l("i",{class:"ri-download-fill text-sm"},null,-1)])],8,ut),l("button",{onClick:g(s=>N(r.id),["stop"]),class:"halo-button text-danger h-8 w-8 flex items-center justify-center bg-white dark:bg-dark-200",title:"删除图片"},[...t[20]||(t[20]=[l("i",{class:"ri-delete-bin-fill text-sm"},null,-1)])],8,pt)])])],2))),128))])):(i(),o("div",gt,[...t[21]||(t[21]=[l("div",{class:"text-5xl text-light-300 dark:text-dark-100 mb-3"},[l("i",{class:"ri-image-line"})],-1),l("p",{class:"text-secondary text-base mb-4"},"暂无上传的图片",-1)])]))]),xe(ye,{name:"float-menu"},{default:ke(()=>[v.value?(i(),o("div",mt,[l("div",vt," 已选 "+b(a.value.length)+" 项 ",1),l("div",ht,[l("button",{onClick:X,class:"floating-btn halo-button w-12 h-12 rounded-full flex items-center justify-center text-lg",title:B.value?"取消全选":"全选"},[l("i",{class:f(B.value?"ri-checkbox-indeterminate-line":"ri-checkbox-multiple-line")},null,2)],8,xt),l("button",{onClick:te,disabled:a.value.length===0,class:"floating-btn halo-button halo-button-primary w-12 h-12 rounded-full flex items-center justify-center text-lg disabled:opacity-50",title:"复制链接"},[...t[22]||(t[22]=[l("i",{class:"ri-link"},null,-1)])],8,ft),l("button",{onClick:Y,disabled:a.value.length===0,class:"floating-btn halo-button halo-button-danger w-12 h-12 rounded-full flex items-center justify-center text-lg disabled:opacity-50",title:"删除记录"},[...t[23]||(t[23]=[l("i",{class:"ri-delete-bin-line"},null,-1)])],8,bt),l("button",{onClick:R,class:"floating-btn halo-button w-12 h-12 rounded-full flex items-center justify-center text-lg",title:"取消"},[...t[24]||(t[24]=[l("i",{class:"ri-close-line"},null,-1)])])])])):L("",!0)]),_:1})]))}};export{_t as default};
